(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[129],{2821:(e,t,s)=>{"use strict";function a(){for(var e,t,s=0,a="",r=arguments.length;s<r;s++)(e=arguments[s])&&(t=function e(t){var s,a,r="";if("string"==typeof t||"number"==typeof t)r+=t;else if("object"==typeof t)if(Array.isArray(t)){var n=t.length;for(s=0;s<n;s++)t[s]&&(a=e(t[s]))&&(r&&(r+=" "),r+=a)}else for(a in t)t[a]&&(r&&(r+=" "),r+=a);return r}(e))&&(a&&(a+=" "),a+=t);return a}s.d(t,{$:()=>a})},35978:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>f});var a=s(95155),r=s(12115),n=s(2821),l=s(71847);let i=(0,l.A)("laptop",[["path",{d:"M18 5a2 2 0 0 1 2 2v8.526a2 2 0 0 0 .212.897l1.068 2.127a1 1 0 0 1-.9 1.45H3.62a1 1 0 0 1-.9-1.45l1.068-2.127A2 2 0 0 0 4 15.526V7a2 2 0 0 1 2-2z",key:"1pdavp"}],["path",{d:"M20.054 15.987H3.946",key:"14rxg9"}]]),o=(0,l.A)("sun-medium",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 3v1",key:"1asbbs"}],["path",{d:"M12 20v1",key:"1wcdkc"}],["path",{d:"M3 12h1",key:"lp3yf2"}],["path",{d:"M20 12h1",key:"1vloll"}],["path",{d:"m18.364 5.636-.707.707",key:"1hakh0"}],["path",{d:"m6.343 17.657-.707.707",key:"18m9nf"}],["path",{d:"m5.636 5.636.707.707",key:"1xv1c5"}],["path",{d:"m17.657 17.657.707.707",key:"vl76zb"}]]),c=(0,l.A)("moon",[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]]),d="pypilot_theme_mode";function m(e){let t="system"===e?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":e,s=document.documentElement;return s.setAttribute("data-theme-mode",e),s.setAttribute("data-theme",t),s.classList.toggle("dark","dark"===t),s.classList.toggle("light","light"===t),t}function h(e){let{className:t}=e,[s,l]=(0,r.useState)("system"),h=(0,r.useRef)("system"),[u,p]=(0,r.useState)("dark"),[x,g]=(0,r.useState)(!1);function y(e){h.current=e,l(e),p(m(e)),localStorage.setItem(d,e)}return((0,r.useEffect)(()=>{let e=localStorage.getItem(d)||localStorage.getItem("pypilot_theme"),t="light"===e||"dark"===e||"system"===e?e:"system";h.current=t,l(t),p(m(t)),g(!0);let s=window.matchMedia("(prefers-color-scheme: dark)"),a=()=>{"system"===h.current&&p(m("system"))};return s.addEventListener("change",a),()=>s.removeEventListener("change",a)},[]),x)?(0,a.jsxs)("div",{className:(0,n.$)("inline-flex items-center gap-1 rounded-xl border border-python-blue/45 bg-slate-900/80 p-1 text-xs text-white shadow-[0_8px_20px_rgba(2,6,23,0.35)] backdrop-blur-sm",t),children:[(0,a.jsxs)("button",{"aria-label":"System theme",title:"System theme",onClick:()=>y("system"),className:(0,n.$)("inline-flex items-center gap-1 rounded-lg px-2 py-1 transition","system"===s?"bg-python-blue/40 text-white":"text-slate-200 hover:bg-white/10"),children:[(0,a.jsx)(i,{size:13}),(0,a.jsx)("span",{className:"hidden sm:inline",children:"System"})]}),(0,a.jsxs)("button",{"aria-label":"Light theme",title:"Light theme",onClick:()=>y("light"),className:(0,n.$)("inline-flex items-center gap-1 rounded-lg px-2 py-1 transition","light"===s?"bg-python-blue/40 text-white":"text-slate-200 hover:bg-white/10"),children:[(0,a.jsx)(o,{size:13}),(0,a.jsx)("span",{className:"hidden sm:inline",children:"Light"})]}),(0,a.jsxs)("button",{"aria-label":"Dark theme",title:"Dark theme",onClick:()=>y("dark"),className:(0,n.$)("inline-flex items-center gap-1 rounded-lg px-2 py-1 transition","dark"===s?"bg-python-blue/40 text-white":"text-slate-200 hover:bg-white/10"),children:[(0,a.jsx)(c,{size:13}),(0,a.jsx)("span",{className:"hidden sm:inline",children:"Dark"})]}),(0,a.jsx)("span",{className:"hidden rounded-md border border-python-yellow/40 px-2 py-1 font-mono text-[10px] text-python-yellow md:inline",children:u})]}):null}var u=s(97003),p=s(83209),x=s(37621),g=s(68209);function y(e){return e.charAt(0).toUpperCase()+e.slice(1)}function f(){var e;let[t,s]=(0,r.useState)(null),[n,l]=(0,r.useState)(""),[i,o]=(0,r.useState)(""),[c,d]=(0,r.useState)("monthly"),[m,f]=(0,r.useState)(!0),[b,v]=(0,r.useState)(""),[w,j]=(0,r.useState)([]),[k,N]=(0,r.useState)(null),[_,S]=(0,r.useState)(null),[A,C]=(0,r.useState)("system"),[E,L]=(0,r.useState)("dark"),[$,M]=(0,r.useState)(""),[P,I]=(0,r.useState)("");async function O(){try{let[e,t,a]=await Promise.all([(0,x.n)("/users/me"),(0,x.n)("/payments/plans").catch(()=>[]),(0,x.n)("/users/me/entitlements")]);s(e),l(e.full_name),o(e.avatar_url||""),j(t),S(a)}catch(e){I("Unable to load settings.")}}(0,r.useEffect)(()=>{function e(){var e,t;let s=document.documentElement,a="light"===(e=s.getAttribute("data-theme-mode")||localStorage.getItem("pypilot_theme_mode")||localStorage.getItem("pypilot_theme"))||"dark"===e||"system"===e?e:"system",r=(t=s.getAttribute("data-theme"),"light"===t||"dark"===t?t:"light"===a||"dark"===a?a:window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");C(a),L(r)}e();let t=document.documentElement,s=new MutationObserver(e);s.observe(t,{attributes:!0,attributeFilter:["data-theme","data-theme-mode"]});let a=window.matchMedia("(prefers-color-scheme: dark)");return a.addEventListener("change",e),window.addEventListener("storage",e),()=>{s.disconnect(),a.removeEventListener("change",e),window.removeEventListener("storage",e)}},[]),(0,r.useEffect)(()=>{O()},[]),(0,r.useEffect)(()=>{!async function(){try{let e=await (0,x.n)("/payments/preview",{method:"POST",body:JSON.stringify({billing_cycle:c,is_student:m,promo_code:b.trim()||null})});N(e)}catch(e){N(null)}}()},[c,m,b]);let T=(0,r.useMemo)(()=>w.find(e=>e.billing_cycle===c)||null,[c,w]);async function U(){I(""),M("");try{let e=await (0,x.n)("/users/me",{method:"PATCH",body:JSON.stringify({full_name:n,avatar_url:i||null})}),t=(0,g.Ti)();t&&(0,g.TV)({...t,full_name:e.full_name}),s(e),M("Profile updated.")}catch(e){I("Unable to save profile.")}}async function Z(){let e=window.location.origin;I(""),M("");try{let t=await (0,x.n)("/payments/checkout",{method:"POST",body:JSON.stringify({success_url:"".concat(e,"/settings?billing=success"),cancel_url:"".concat(e,"/settings?billing=cancelled"),billing_cycle:c,is_student:m,promo_code:b.trim()||null})});window.location.href=t.checkout_url}catch(e){I(e instanceof Error?e.message:"Unable to start subscription checkout.")}}return t?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)(p.Z,{children:[(0,a.jsx)("h1",{className:"text-xl font-semibold",children:"Settings"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-slate-300",children:"Manage profile, pricing, subscription, and account preferences."})]}),(0,a.jsxs)(p.Z,{children:[(0,a.jsx)("h2",{className:"mb-3 text-lg font-semibold",children:"Profile"}),(0,a.jsxs)("div",{className:"grid gap-3 md:grid-cols-2",children:[(0,a.jsx)("input",{value:n,onChange:e=>l(e.target.value),className:"rounded-xl border border-white/10 bg-slate-950/60 px-3 py-2",placeholder:"Full name"}),(0,a.jsx)("input",{value:i,onChange:e=>o(e.target.value),className:"rounded-xl border border-white/10 bg-slate-950/60 px-3 py-2",placeholder:"Avatar URL"})]}),(0,a.jsxs)("div",{className:"mt-3 flex items-center gap-3",children:[(0,a.jsx)(u.$,{onClick:U,children:"Save Profile"}),$&&(0,a.jsx)("p",{className:"text-sm text-brand-200",children:$})]}),(0,a.jsxs)("p",{className:"mt-3 text-sm text-slate-300",children:["Email: ",t.email]})]}),(0,a.jsxs)(p.Z,{children:[(0,a.jsx)("h2",{className:"mb-2 text-lg font-semibold",children:"Appearance"}),(0,a.jsx)("p",{className:"text-sm text-slate-300",children:"Choose your workspace theme mode. `System` follows your device setting."}),(0,a.jsx)("div",{className:"mt-3",children:(0,a.jsx)(h,{})}),(0,a.jsxs)("p",{className:"mt-2 text-xs text-slate-400",children:["Active theme:"," ",(0,a.jsx)("span",{className:"font-mono text-python-yellow",children:"system"===A?"".concat(y(A)," -> ").concat(y(E)):y(A)})]}),(0,a.jsx)("p",{className:"mt-2 text-xs text-slate-400",children:"Theme preference is stored on this browser/device."})]}),(0,a.jsxs)("section",{className:"grid gap-4 lg:grid-cols-[1fr_420px]",children:[(0,a.jsxs)(p.Z,{children:[(0,a.jsx)("h2",{className:"mb-3 text-lg font-semibold",children:"Subscription Plans"}),(0,a.jsxs)("div",{className:"mb-3 flex gap-2",children:[(0,a.jsx)(u.$,{variant:"monthly"===c?"primary":"ghost",onClick:()=>d("monthly"),children:"Monthly"}),(0,a.jsx)(u.$,{variant:"annual"===c?"primary":"ghost",onClick:()=>d("annual"),children:"Annual"})]}),(0,a.jsx)("div",{className:"space-y-3",children:w.map(e=>(0,a.jsxs)("div",{className:"rounded-xl border p-3 ".concat(e.billing_cycle===c?"border-brand-300/40 bg-brand-500/10":"border-white/10 bg-slate-950/60"),children:[(0,a.jsx)("p",{className:"font-medium",children:e.label}),(0,a.jsxs)("p",{className:"mt-1 text-sm text-slate-300",children:["$",e.amount_usd," / ",e.billing_cycle]}),(0,a.jsx)("ul",{className:"mt-2 space-y-1 text-xs text-slate-300",children:e.features.map(e=>(0,a.jsxs)("li",{children:["- ",e]},e))})]},e.code))})]}),(0,a.jsxs)(p.Z,{children:[(0,a.jsx)("h2",{className:"mb-3 text-lg font-semibold",children:"Checkout Preview"}),(0,a.jsxs)("label",{className:"mb-2 flex items-center gap-2 text-sm",children:[(0,a.jsx)("input",{type:"checkbox",checked:m,onChange:e=>f(e.target.checked)}),"Apply student pricing"]}),(0,a.jsx)("input",{value:b,onChange:e=>v(e.target.value.toUpperCase()),className:"w-full rounded-xl border border-white/10 bg-slate-950/60 px-3 py-2",placeholder:"Promo code (optional)"}),k?(0,a.jsxs)("div",{className:"mt-3 space-y-1 text-sm text-slate-200",children:[(0,a.jsxs)("p",{children:["Base: $",k.base_amount_usd]}),(0,a.jsxs)("p",{children:["Discount: ",k.discount_percent,"%"]}),(0,a.jsxs)("p",{className:"font-semibold text-brand-200",children:["Final: $",k.final_amount_usd]}),(0,a.jsxs)("p",{className:"text-xs text-slate-400",children:["Promo: ",k.applied_promo_code||"none"]})]}):(0,a.jsx)("p",{className:"mt-3 text-sm text-slate-300",children:"Pricing preview unavailable."}),(0,a.jsx)(u.$,{className:"mt-4 w-full",variant:"secondary",onClick:Z,children:"Upgrade with Stripe"}),(0,a.jsxs)("div",{className:"mt-3 rounded-lg border border-white/10 bg-slate-950/70 p-3 text-xs text-slate-300",children:[(0,a.jsxs)("p",{children:["Current plan: ",(null==_?void 0:_.plan_tier)||"free"]}),(0,a.jsxs)("p",{children:["Subscription status: ",(null==_?void 0:_.subscription_status)||"free"]}),(0,a.jsxs)("p",{children:["AI credits today: ",null!=(e=null==_?void 0:_.ai_credits_remaining)?e:0]})]}),T&&(0,a.jsxs)("p",{className:"mt-2 text-xs text-slate-400",children:["Selected plan code: ",T.code]})]})]}),P&&(0,a.jsx)("p",{className:"text-sm text-red-300",children:P})]}):(0,a.jsx)("p",{className:"text-slate-300",children:"Loading settings..."})}},37621:(e,t,s)=>{"use strict";s.d(t,{n:()=>c});var a,r=s(68209);let n=null==(a=s(95704).env.NEXT_PUBLIC_API_URL)?void 0:a.trim(),l=n&&n.length>0?n:"/api",i="/api";async function o(e){if((e.headers.get("content-type")||"").includes("application/json")){let t=await e.json().catch(()=>null);if(t&&"string"==typeof t.detail)return t.detail;if(t&&Array.isArray(t.detail))return t.detail.map(e=>null==e?void 0:e.msg).filter(Boolean).join(", ")}return await e.text()||"Request failed with status ".concat(e.status)}async function c(e){let t,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=!(arguments.length>2)||void 0===arguments[2]||arguments[2],n=new Headers(s.headers||{}),c=void 0!==s.body,d="undefined"!=typeof FormData&&s.body instanceof FormData;if(!c||d||n.has("Content-Type")||n.set("Content-Type","application/json"),a){let e=(0,r.gf)();e&&n.set("Authorization","Bearer ".concat(e))}let m=e.startsWith("/")?e:"/".concat(e);async function h(e){return fetch("".concat(e).concat(m),{...s,headers:n,credentials:"include"})}try{t=await h(l)}catch(e){if(l!==i)t=await h(i);else throw e}if(!t.ok)throw Error(await o(t));return t.json()}},68209:(e,t,s)=>{"use strict";s.d(t,{TV:()=>r,Ti:()=>l,gf:()=>n});let a="pypilot_user";function r(e){localStorage.removeItem("pypilot_access_token"),localStorage.setItem(a,JSON.stringify(e))}function n(){return null}function l(){let e=localStorage.getItem(a);if(!e)return null;try{return JSON.parse(e)}catch(e){return null}}},71847:(e,t,s)=>{"use strict";s.d(t,{A:()=>o});var a=s(12115);let r=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,s)=>s?s.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)},n=function(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return t.filter((e,t,s)=>!!e&&""!==e.trim()&&s.indexOf(e)===t).join(" ").trim()};var l={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let i=(0,a.forwardRef)((e,t)=>{let{color:s="currentColor",size:r=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:c="",children:d,iconNode:m,...h}=e;return(0,a.createElement)("svg",{ref:t,...l,width:r,height:r,stroke:s,strokeWidth:o?24*Number(i)/Number(r):i,className:n("lucide",c),...!d&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(h)&&{"aria-hidden":"true"},...h},[...m.map(e=>{let[t,s]=e;return(0,a.createElement)(t,s)}),...Array.isArray(d)?d:[d]])}),o=(e,t)=>{let s=(0,a.forwardRef)((s,l)=>{let{className:o,...c}=s;return(0,a.createElement)(i,{ref:l,iconNode:t,className:n("lucide-".concat(r(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),"lucide-".concat(e),o),...c})});return s.displayName=r(e),s}},83209:(e,t,s)=>{"use strict";s.d(t,{Z:()=>n});var a=s(95155),r=s(2821);function n(e){let{className:t,...s}=e;return(0,a.jsx)("div",{className:(0,r.$)("rounded-2xl border border-white/10 bg-slate-950/70 p-4 shadow-[0_10px_25px_rgba(2,6,23,0.35)]",t),...s})}},84228:(e,t,s)=>{Promise.resolve().then(s.bind(s,35978))},97003:(e,t,s)=>{"use strict";s.d(t,{$:()=>n});var a=s(95155),r=s(2821);function n(e){let{children:t,className:s,variant:n="primary",...l}=e;return(0,a.jsx)("button",{className:(0,r.$)("inline-flex items-center justify-center rounded-xl px-4 py-2 text-sm font-semibold transition duration-150","disabled:cursor-not-allowed disabled:opacity-60","primary"===n&&"bg-gradient-to-r from-python-blue to-python-blueLight text-white hover:brightness-110","secondary"===n&&"bg-gradient-to-r from-python-yellow to-amber-300 text-slate-950 hover:brightness-105","ghost"===n&&"border border-white/20 bg-transparent text-white hover:bg-white/10",s),...l,children:t})}}},e=>{e.O(0,[441,255,358],()=>e(e.s=84228)),_N_E=e.O()}]);